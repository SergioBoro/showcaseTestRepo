<html>
<head>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<link rel="stylesheet" href="../../../dijit/themes/claro/claro.css"/>


<script src="https://www.google.com/jsapi?key=ABQIAAAA-DMAtggvLwlIYlUJiASaAxRQnCpeV9jusWIeBw0POFqU6SItGxRWZhddpS8pIkVUd2fDQhzwPUWmMA"></script>


<script>
    djConfig = {
        isDebug: true,
		parseOnLoad: false,
        modulePaths: {course: "../course", courseApp: "../course/geo/tests"},
		gfxRenderer: "svg,silverlight",
		mapEngine: "gfx"
    };
</script>
<script src="utils.js"></script>

<script src="../../../dojo/dojo.js"></script>
<script src="../../../course/geo/Map.js"></script>
<script src="../../../course/geo/Feature.js"></script>
<script src="../../../course/geo/FeatureContainer.js"></script>
<script src="../../../course/geo/Placemark.js"></script>
<script src="../../../course/geo/styling.js"></script>
<script src="../../../course/geo/gfx/Placemark.js"></script>
<script src="../../../course/geo/utils.js"></script>
<script src="../../../course/geo/control/Magnify.js"></script>
<script src="../../../course/geo/control/Highlight.js"></script>
<script src="../../../course/geo/control/Tooltip.js"></script>
<script src="../../../course/geo/projection.js"></script>


<script>
if (djConfig.mapEngine=="ge") dojo.require("course.geo.ge.Engine");

dojo.require("dijit.form.Button");
dojo.require("course.geo.control.Magnify");
dojo.require("course.geo.control.Highlight");
dojo.require("course.geo.control.Tooltip");

dojo.require("courseApp.data.berlin_buildings");
dojo.require("courseApp.data.berlin_lines");


dojo.require("course.geo.utils.proj4js");
dojo.require("course.geo.utils.proj4js.merc");
dojo.require("course.geo.projection");


var map, magnify, highlight, tooltip;

var style = [
	{
		styleClass: "buildings",
		fill: "#bca9a9",
		strokeWidth: 0.001
	},
	{
		styleClass: "lines",
		stroke: "#bbb",
		strokeWidth: 1
	},
	{
		styleClass: "lines",
		filter: "this.highway=='primary'",
		stroke: "#8d4346",
		strokeWidth: 3
	},
	{
		styleClass: "lines",
		filter: "this.highway=='secondary'",
		stroke: "#a37b48",
		strokeWidth: 2.5
	},
	{
		styleClass: "lines",
		filter: "this.highway=='tertiary'",
		stroke: "#ffffb3",
		strokeWidth: 1.8
	},
	{
		styleClass: "lines",
		filter: "this.railway",
		stroke: "#000",
		strokeWidth: 0.5
	}
]

var features = [
	{
		id: "buildings",
		styleClass: "buildings",
		features: courseApp.data.berlinBuildings
	},
	{
		styleClass: "lines",
		features: courseApp.data.berlinLines
	}
]

var highlight, magnify, tooltip;
var addOnLoad = function() {
	/*
    new dijit.form.ToggleButton({
		checked: true,
		onChange: function(value){
			if (value) magnify.connect();
			else magnify.disconnect();
		},
		iconClass: "dijitRadioIcon"
	}, "magnify");
	
    new dijit.form.ToggleButton({
		checked: true,
		onChange: function(value){
			if (value) highlight.connect();
			else highlight.disconnect();
		},
		iconClass: "dijitRadioIcon"
	}, "highlight");
	*/
    new dijit.form.ToggleButton({
		checked: true,
		onChange: function(value){
			if (value) tooltip.connect();
			else tooltip.disconnect();
		},
		iconClass: "dijitRadioIcon"
	}, "tooltip");

    map = new course.geo.Map("map", {
		geometryProjection: "EPSG:4326",
		currentProjection: "EPSG:3785",
		engine: {type: djConfig.mapEngine},
		style: style,
		features: features
	});
	map.ready(function(){
		highlight = new course.geo.control.Highlight("buildings", {map: map});
		magnify = new course.geo.control.Magnify("buildings", {map: map, scale: 2});
		tooltip = new course.geo.control.Tooltip("buildings", {map: map});
	});
}



dojo.addOnLoad(addOnLoad);

</script>

</head>

<body class="claro">

<!--
<div id="magnify">Magnify</div>
<div id="highlight">Highlight</div>
-->
<div id="tooltip">Tooltip</div>
<div id="map" style="width:600px;height:600px;"></div>
Map data (c) <a href="http://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>.
</body>
</html>